<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.eds.wx.pay">    <select id="queryPayOrderWithLock" resultType="com.eds.ma.bis.order.entity.PayOrder">        SELECT *        FROM t_t_eds_pay_order        WHERE payCode = #{payCode} AND dataStatus = 1 FOR UPDATE    </select>    <update id="updatePayOrderForCallBack">        UPDATE t_t_eds_pay_order        SET            notifyId    = #{notifyId},            payStatus   = #{payStatus},            tradeNo     = #{tradeNo},            buyerId     = #{buyerId},            totalFee    = #{totalFee},            cashFee     = #{cashFee},            payTime     = #{payTime},            bankType    = #{bankType},            sellerId    = #{sellerId},            appId       = #{appId},            isSubscribe = #{isSubscribe}        WHERE payCode = #{payCode} AND payStatus = 'WAIT_BUYER_PAY'    </update>    <select id="queryToRefundPayOrder" resultType="com.eds.ma.bis.order.entity.PayOrder">        SELECT *        FROM t_t_eds_pay_order epo        WHERE (epo.buyerId = #{openId} or epo.buyerId = #{aliUid}) AND epo.dataStatus = 1 AND epo.payStatus = 'TRADE_SUCCESS'              AND epo.payMoney > 0        ORDER BY epo.payMoney DESC        FOR UPDATE    </select></mapper>